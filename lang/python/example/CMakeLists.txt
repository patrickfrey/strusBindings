cmake_minimum_required( VERSION 2.6 FATAL_ERROR )

set( THISDIR "${PROJECT_SOURCE_DIR}/lang/python/example" )
set( tests helloWorld createCollection query query_trace queryexpr status )
IF (WITH_STRUS_PATTERN STREQUAL "YES")
set( tests ${tests} querypattern )
ENDIF (WITH_STRUS_PATTERN STREQUAL "YES")
IF (WITH_STRUS_VECTOR STREQUAL "YES")
set( tests ${tests} vectors )
ENDIF (WITH_STRUS_VECTOR STREQUAL "YES")

if( CMAKE_MAJOR_VERSION GREATER 2 OR CMAKE_MINOR_VERSION GREATER 6 )
	foreach( test ${tests} )
		add_test( NAME python_${test} COMMAND /usr/bin/env python2 ${test}.py WORKING_DIRECTORY ${THISDIR} )
		if(APPLE OR WIN32)
			set_tests_properties( python_${test} PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python/${CMAKE_BUILD_TYPE}" )
		else(APPLE OR WIN32)
			set_tests_properties( python_${test} PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
		endif(APPLE OR WIN32)
	endforeach( test )
else( CMAKE_MAJOR_VERSION GREATER 2 OR CMAKE_MINOR_VERSION GREATER 6 )
	add_test( python_helloWorld /usr/bin/env python2 helloWorld.py WORKING_DIRECTORY ${THISDIR} )
	add_test( python_createCollection /usr/bin/env python2 createCollection.py WORKING_DIRECTORY ${THISDIR} )
	add_test( python_query /usr/bin/env python2 query.py WORKING_DIRECTORY ${THISDIR} )
	add_test( python_query_trace /usr/bin/env python2 query_trace.py WORKING_DIRECTORY ${THISDIR} )
	add_test( python_queryexpr /usr/bin/env python2 queryexpr.py WORKING_DIRECTORY ${THISDIR} )
IF (WITH_STRUS_PATTERN STREQUAL "YES")
	add_test( python_querypattern /usr/bin/env python2 querypattern.py WORKING_DIRECTORY ${THISDIR} )
ENDIF (WITH_STRUS_PATTERN STREQUAL "YES")
IF (WITH_STRUS_VECTOR STREQUAL "YES")
	add_test( python_vectors /usr/bin/env python2 vectors.py WORKING_DIRECTORY ${THISDIR} )
ENDIF (WITH_STRUS_VECTOR STREQUAL "YES")
	add_test( python_status /usr/bin/env python2 status.py WORKING_DIRECTORY ${THISDIR} )
	set_tests_properties( python_helloWorld PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
	set_tests_properties( python_createCollection PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
	set_tests_properties( python_query PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
	set_tests_properties( python_query_trace PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
	set_tests_properties( python_queryexpr PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
IF (WITH_STRUS_PATTERN STREQUAL "YES")
	set_tests_properties( python_querypattern PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
ENDIF (WITH_STRUS_PATTERN STREQUAL "YES")
IF (WITH_STRUS_VECTOR STREQUAL "YES")
	set_tests_properties( python_vectors PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
ENDIF (WITH_STRUS_VECTOR STREQUAL "YES")
	set_tests_properties( python_status PROPERTIES ENVIRONMENT "PYTHONPATH=${PROJECT_SOURCE_DIR}/lang/python" )
endif( CMAKE_MAJOR_VERSION GREATER 2 OR CMAKE_MINOR_VERSION GREATER 6 )

